jQuery(document).ready(function(e){"use strict";var a,n=function(e){return e.is(".processing")||e.parents(".processing").length},t=function(a){if(e("body").trigger("nasa_publish_coupon_refresh"),!n(a)){var t=e("body").hasClass("nasa-dark")?"#000":"#fff";a.addClass("processing").block({message:null,overlayCSS:{background:t,opacity:.6}})}},o=function(a){a.removeClass("processing").unblock(),a.find(".nasa-close-node").length&&a.find(".nasa-close-node").trigger("click"),e("body").trigger("nasa_publish_coupon_refresh")},s=function(e){return ext_mini_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",e)},i=function(n){e(".ext-mini-cart-wrap .mess-wrap").remove(),e(".ext-mini-cart-wrap").append('<div class="mess-wrap">'+n+"</div>"),a&&clearTimeout(a),a=setTimeout(function(){e(".ext-mini-cart-wrap .mess-wrap").remove()},5e3)};e("body").on("nasa_opened_cart_sidebar",function(){e("body").hasClass("canvas-on")||e("body").addClass("canvas-on"),e("body").trigger("nasa_load_ext_mini_cart")}),e("body").on("nasa_after_close_fog_window",function(){e("body").removeClass("canvas-on")}),e("body").on("click",".nasa-close-node",function(){var a=e(this).parents(".nasa-static-sidebar"),n=e(this).parents(".ext-node");e(a).length&&e(a).removeClass("ext-loading"),e(n).length&&e(n).removeClass("active"),e(a).find(".ext-nodes-wrap .close-nodes").remove()}),e("body").on("click",".ext-nodes-wrap .close-nodes",function(){var a=e(this).parents(".ext-nodes-wrap"),n=e(a).find(".ext-node.active .nasa-close-node");e(n).length&&e(n).trigger("click")}),e("body").on("click",".ext-mini-cart",function(){var a=e(this).attr("data-act"),n=e(this).parents(".nasa-static-sidebar");e(n).find(".ext-mini-cart-wrap").length&&!e(n).find(".ext-mini-cart-wrap").hasClass("nasa-disable")&&(e("body").hasClass("canvas-on")||e("body").addClass("canvas-on"),e(n).hasClass("ext-loading")||e(n).addClass("ext-loading"),e(n).find(".ext-nodes-wrap").length<1&&e(n).append('<div class="ext-nodes-wrap"></div>'),e(n).find(".ext-nodes-wrap .close-nodes").length<1&&e(n).find(".ext-nodes-wrap").prepend('<a href="javascript:void(0);" class="close-nodes"></a>'),e(n).find(".ext-nodes-wrap .ext-node").removeClass("active"),e(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+a).length?e(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+a).addClass("active"):e.ajax({url:s("nasa_ext_mini_cart"),type:"post",dataType:"json",cache:!1,data:{act:a},success:function(t){"undefined"!=typeof t.content&&(e(n).find(".ext-nodes-wrap").append(t.content),"shipping"===a&&setTimeout(function(){e(n).find("select.country_to_state, input.country_to_state").trigger("change"),e(document.body).trigger("country_to_state_changed")},100),setTimeout(function(){e(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+a).length&&e(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+a).addClass("active")},300))},error:function(){e(n).removeClass("ext-loading")}}))}),e("body").on("nasa_load_ext_mini_cart",function(){var a=e("#cart-sidebar");e("body").hasClass("canvas-on")||e("body").addClass("canvas-on"),e(a).find(".ext-nodes-wrap").length<1&&e(a).append('<div class="ext-nodes-wrap"></div>'),e(a).find(".ext-nodes-wrap .ext-node").length<1&&e.ajax({url:s("nasa_all_ext_mini_cart"),type:"post",dataType:"json",cache:!1,data:{},beforeSend:function(){e(".ext-mini-cart-wrap").length&&e(".ext-mini-cart-wrap").addClass("nasa-disable")},success:function(n){"undefined"!=typeof n.content&&(e(a).find(".ext-nodes-wrap").append(n.content),e(a).find("select.country_to_state, input.country_to_state").length&&setTimeout(function(){e(a).find("select.country_to_state, input.country_to_state").trigger("change"),e(document.body).trigger("country_to_state_changed")},100),e("body").trigger("nasa_publish_coupon_refresh")),e(".ext-mini-cart-wrap").length&&e(".ext-mini-cart-wrap").removeClass("nasa-disable")}})}),e("body").on("click","#mini-cart-save_note",function(a){a.preventDefault();var n=e(this);if(!e(n).hasClass("nasa-disable")){e(n).addClass("nasa-disable");var r=e(n).parents(".nasa-static-sidebar");e(r).length<1&&(r=e(n).parents(".widget_shopping_cart_content"));var c=e('.mini-cart-note textarea[name="order_comments"]').val();t(r),e.ajax({url:s("nasa_mini_cart_note"),type:"post",dataType:"json",cache:!1,data:{order_comments:c},success:function(a){e(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),e(n).removeClass("nasa-disable"),a&&(a.fragments&&(e.each(a.fragments,function(a,n){e(a).length&&e(a).replaceWith(n)}),e("body").trigger("wc_fragments_refreshed"),e("body").trigger("nasa_init_shipping_free_notification")),a.mess&&i(a.mess)),o(r)},complete:function(){o(r)}})}}),e("body").on("nasa_publish_coupon_refresh",function(){e(".mini-cart-coupon .publish-coupon").length&&e(".mini-cart-coupon .publish-coupon").each(function(){var a=e(this),n=e(a).attr("data-code");e(a).removeClass("nasa-actived"),e('.coupon-wrap[data-code="'+n+'"]').length&&e(a).addClass("nasa-actived")})}),e("body").on("click",".mini-cart-coupon .publish-coupon:not(.nasa-actived)",function(){var a=this,n=e(a).attr("data-code");e("#mini-cart-add-coupon_code").length&&(e("#mini-cart-add-coupon_code").val(n).trigger("change"),e("#mini-cart-apply_coupon").length&&e("#mini-cart-apply_coupon").trigger("click"))}),e("body").on("click","#mini-cart-apply_coupon",function(a){a.preventDefault();var n=e(this),r=e(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").length?e(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").val():null;if(r&&!e(n).hasClass("nasa-disable")){e(n).addClass("nasa-disable");var c=e(n).parents(".nasa-static-sidebar");e(c).length<1&&(c=e(n).parents(".widget_shopping_cart_content"));var d=e("input#mini-cart-add-coupon_code").val();if(d){t(c);var p={security:r,coupon_code:d};e.ajax({type:"POST",url:s("nasa_mini_cart_apply_coupon"),data:p,dataType:"json",success:function(a){e(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),e(n).removeClass("nasa-disable"),a&&(a.fragments&&(e.each(a.fragments,function(a,n){e(a).length&&e(a).replaceWith(n)}),e("body").trigger("wc_fragments_refreshed"),e("body").trigger("nasa_init_shipping_free_notification")),a.mess&&i(a.mess),e("input#mini-cart-add-coupon_code").val("").trigger("change")),o(c)},complete:function(){o(c)}})}else e(n).removeClass("nasa-disable")}}),e("body").on("click",".widget_shopping_cart_content .woocommerce-remove-coupon",function(a){a.preventDefault();var n=e(this),r=e(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").length?e(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").val():null;if(r&&!e(n).hasClass("nasa-disable")){e(n).addClass("nasa-disable");var c=e(n).parents(".nasa-static-sidebar");e(c).length<1&&(c=e(n).parents(".widget_shopping_cart_content")),t(c);var d=e(n).attr("data-coupon"),p={security:r,coupon:d};e.ajax({type:"POST",url:s("nasa_mini_cart_remove_coupon"),data:p,dataType:"json",success:function(a){e(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),e(n).removeClass("nasa-disable"),a&&(a.fragments&&(e.each(a.fragments,function(a,n){e(a).length&&e(a).replaceWith(n)}),e("body").trigger("wc_fragments_refreshed"),e("body").trigger("nasa_init_shipping_free_notification")),a.mess&&i(a.mess)),o(c)},complete:function(){o(c)}})}}),e("body").on("click",'.mini-cart-shipping [name="calc_shipping"]',function(a){a.preventDefault();var n=e(this);if(!e(n).hasClass("nasa-disable")){e(n).addClass("nasa-disable");var r=e(n).parents(".ext-node"),c=e(n).parents("form");t(r),e("<input />").attr("type","hidden").attr("name","calc_shipping").attr("value","x").appendTo(c);var d=c.serialize();e.ajax({type:"POST",url:s("nasa_mini_cart_calculate_shipping"),data:d,dataType:"json",success:function(a){e(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),e(n).removeClass("nasa-disable"),a&&(a.fragments&&(e.each(a.fragments,function(a,n){e(a).length&&e(a).replaceWith(n)}),e("body").trigger("wc_fragments_refreshed"),e("body").trigger("nasa_init_shipping_free_notification")),a.mess&&i(a.mess)),o(r)},complete:function(){o(r)}})}})});